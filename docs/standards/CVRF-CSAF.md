<!-- markdownlint-disable MD034 -->

# CSAF Common Vulnerability Reporting Framework (CVRF)

- Language to exchange Security Advisories formulated in XML
- Three main classes of the information:
  1. The frame, aggregation, and reference information of the document
  2. Product information considered relevant by the creator
  3. Vulnerability information and its relation to the products declared in 2.

NOTE: The 2.0 version of the schema - which uses JSON schema instead of XML - is in development: https://github.com/oasis-tcs/csaf/tree/master/csaf_2.0/json_schema

## Document (Context) Schema Elements

1. Title
2. Type
3. Publisher
   - [A] Type
   - [A] Vendor ID
   - Contact Details
   - Issuing Authority
4. Tracking
   - Identification
     - ID
     - Alias
   - Status
   - Version
   - Revision History
     - Revision
       - Description
       - Date
       - Number
   - Initial Release Date
   - Current Release Date
   - Generator
     - Engine
     - Date
5. Notes
   - Note
     - [A] Title
     - [A] Audience
     - [A] Type
     - [A] Ordinal
6. Distribution
7. Aggregate Severity
8. References
   - Reference
     - URL
     - Description
9. Acknowledgements
   - Achnowledgement
     - Name
     - Organzation
     - Description
     - URL

## Product Tree Schema Elements

1. Branch
   - [A] Name
   - [A] Type
2. Full Product Name
   - [A] Product ID
   - [A] CPE
3. Relationship
   - [A] ProductReference
   - [A] RelationType
   - [A] RelatesToProductReference
4. Product Groups
   - Group
     - [A] Group ID
     - Description
     - Product ID

## Vulnerability Schema Elements

1. Title
2. ID
3. Notes
   - Note
     - [A] Type
     - [A] Ordinal
     - [A] Title
     - [A] Audience
4. Discovery Date
5. Release Date
6. Involvements
   - Involvement
     - [A] Party
     - [A] Status
     - Description
7. CVE
8. CWE
9. Product Statuses
   - Status
   - Product ID
10. Threats
    - Threat
      - [A] Type
      - [A] Date
      - Description
      - Product ID
      - Group ID
11. CVSS Score Sets
    - Score Set V2
      - Base Score V2
      - Temporal Score V2
      - Environmental Score V2
      - Vector V2
      - Product ID
    - Score Set V3
      - Base Score V3
      - Temporal Score V3
      - Environmental Score V3
      - Vector V3
      - Product ID
12. Remediations
    - Remediation
      - [A] Type
      - Description
      - Entitlement
      - URL
      - Product ID
      - Group ID
13. References
    - Reference
      - [A] Type
      - URL
      - Description
14. Acknowledgements
    - Name
    - Organization
    - Description
    - URL

[A] declares an attribute instead of a child element

## Examples

### Real-world examples

- ftp://ftp.suse.com/pub/projects/security/cvrf/
- https://tools.cisco.com/security/center/cvrfListing.x
- https://www.redhat.com/security/data/cvrf/

### Fiction Example with explanation

#### CSRF shema

```xml
<?xml version='1.0' encoding='UTF-8'?>
<cvrfdoc>
   <!-- Document wide context information -->
   <DocumentTitle xml:lang="en">Acme Security Advisory for foo on bar - March 2017 - CSAF CVRF</DocumentTitle>
   <DocumentType xml:lang="en">Acme Security Advisory</DocumentType>
   <DocumentPublisher Type="Vendor"/>
   <DocumentTracking>
      <Identification>
         <ID>acme-2017-42</ID>
      </Identification>
      <Status>Final</Status>
      <Version>1.0</Version>
      <RevisionHistory>
         <Revision>
            <Number>1.0</Number>
            <Date>2017-03-17T12:34:56-06:00</Date>
            <Description>Initial Distribution</Description>
         </Revision>
         <Revision>
            <Number>1.1</Number>
            <Date>2017-03-18T01:23:45-06:00</Date>
            <Description>Corrected Distribution</Description>
         </Revision>
      </RevisionHistory>
      <InitialReleaseDate>2017-01-17T12:34:56-06:00</InitialReleaseDate>
      <CurrentReleaseDate>2017-01-18T01:23:34-06:00</CurrentReleaseDate>
   </DocumentTracking>
   <DocumentNotes>
      <Note Audience="All" Ordinal="1" Title="Summary" Type="Summary" xml:lang="en">
         This document contains descriptions of Acme product security vulnerabilities with details on impacted and non-impacted platform product combinations.
         Additional information regarding these vulnerabilities including fix distribution information can be found at the Acme sites referenced in this document.</Note>
   </DocumentNotes>
   <DocumentDistribution>This document is published at: https://acme.example.com/sa/acme-2017-42-1-1.xml</DocumentDistribution>
   <DocumentReferences>
      <Reference Type="External">
         <URL>https://acme.example.com/sa/acme-2017-42-1-1.json</URL>
         <Description>URL to JSON version of Advisory</Description>
      </Reference>
   </DocumentReferences>
   <Acknowledgments>
      <Acknowledgment>
         <Name>Some One (not to be named explicitly)</Name>
      </Acknowledgment>
      <Acknowledgment>
         <Name>Jane Employee</Name>
         <Organization>Acme Inc.</Organization>
      </Acknowledgment>
   </Acknowledgments>

   <!-- Product tree section -->
   <ProductTree xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/prod">
      <Branch Name="Acme" Type="Vendor">
         <Branch Name="Acme Things" Type="Product Family">
            <Branch Name="Things On bar" Type="Product Name">
               <Branch Name="1.9" Type="Product Version">
                  <FullProductName ProductID="AC-FOO-1.9-on-bar">Foo 1.9 on bar</FullProductName>
               </Branch>
               <Branch Name="2.1" Type="Product Version">
                  <FullProductName ProductID="AC-FOO-2.1-on-bar">Foo 2.1 on bar</FullProductName>
               </Branch>
            </Branch>
            <Branch Name="Things On baz" Type="Product Name">
               <Branch Name="1.9" Type="Product Version">
                  <FullProductName ProductID="AC-FOO-1.9-on-baz">Foo 1.9 on baz</FullProductName>
               </Branch>
               <Branch Name="2.1" Type="Product Version">
                  <FullProductName ProductID="AC-FOO-2.1-on-baz">Foo 2.1 on baz</FullProductName>
               </Branch>
            </Branch>
         </Branch>
       </Branch>
   </ProductTree>

   <!-- Vulnerability sections -->
   <Vulnerability Ordinal="1" xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/vuln">
      <Title>Vulnerability in the TCP component of Acme foo (CVE-2017-99999)</Title>
      <Notes>
         <Note Audience="All" Ordinal="1" Title="Details" Type="Details">
            Vulnerability in the TCP component of Acme foo.
            Supported versions that are affected are 1.9, and 2.0 when installed on bar but not affected when on baz.
            Easily exploitable vulnerability allows unauthenticated attacker with network access via a single 0x42 value payload byte to compromise Acme foo.
            Successful attacks of this vulnerability can result in unauthorized read access to a subset of Acme foo accessible data and unauthorized ability to cause a complete denial of service (DOS) of Acme foo.
            CVSS 3.0 Base Score 9.8 (Confidentiality and Availability impacts).
            CVSS Vector: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).</Note>
      </Notes>
      <Involvements>
         <Involvement Party="Vendor" Status="Completed">
            <Description>Fix has been released</Description>
         </Involvement>
      </Involvements>
      <CVE>CVE-2017-99999</CVE>
      <ProductStatuses>
         <Status Type="Known Affected">
            <ProductID>AC-FOO-1.9-on-bar</ProductID>
            <ProductID>AC-FOO-2.1-on-bar</ProductID>
         </Status>
         <Status Type="Known Not Affected">
            <ProductID>AC-FOO-1.9-on-baz</ProductID>
            <ProductID>AC-FOO-2.1-on-baz</ProductID>
         </Status>
      </ProductStatuses>
      <CVSSScoreSets>
         <ScoreSetV3>
            <BaseScoreV3>9.8</BaseScoreV3>
            <VectorV3>CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H</VectorV3>
         </ScoreSetV3>
      </CVSSScoreSets>
      <Remediations>
         <Remediation Type="Vendor Fix">
            <Description>acme-2017-42</Description>
            <Entitlement xml:lang="it">Tutte le persone su questo pianeta</Entitlement>
            <URL>https://acme.example.com/sa/acme-2017-42-1-1.html</URL>
            <ProductID>AC-FOO-1.9-on-bar</ProductID>
            <ProductID>AC-FOO-2.1-on-bar</ProductID>
         </Remediation>
      </Remediations>
   </Vulnerability>
   <!-- No more elements to follow -->
</cvrfdoc>
```

#### Explanation

1. The vendor is assumed to be named ACME Inc., and DNS-wise only hosted on a subdomain of example.com i.e. https://acme.example.com/ and per time zone offset 6 hours “behind” UTC.
2. A product foo is declared to be available on platforms bar and baz alike and in version 1.9 and 2.1.
3. The CVE is made up. No CWE is given. A CVSS Score is given in CVSSv3 and this is repeated in the human readable portions (maybe because the vendor uses this as accessibility feature)
4. Some possible combinations of vulnerability and mitigation states are realized i.e.:
   - Product foo is always known to be affected on platform bar.
   - Product foo is always known not to be affected on platform baz.
5. A remediation page is offered at https://acme.example.com/sa/acme-2017-42-1-1.html. Everyone is entitled, but this fact is written in Italian.
6. The source of the CSAF CVRF version 1.2 security advisory (XML) is offered at https://acme.example.com/sa/acme-2017-42-1-1.xml and an also fictitious variant (for now vendor private) in JSON at https://acme.example.com/sa/acme-2017-42-1-1.json.
7. There are two revisions (in total). Maybe the initial release of the security advisory did not take into account, that the product when installed on the baz platform is unaffected, or there was given the wrong exploit byte value. Without access to the initial revision, and with no explanation in the release notes, we cannot know
8. The acknowledgment was maybe chosen by the company lawyers to not list the real name of the external contributor where the below sample content states “Some One (not to be named explicitly)” – and no dummy Organization is added.
9. The complexity of the Affected/Non-Affected mixture may have forced the publisher to not take the internal usual product IDs but instead append the interesting dimension in a simple serialization as: “-on-bar” and “-on-baz” respectively. In a real life advisory, these simple platform names might have become fully fledged product entries themselves with relationship link elements between them.
   more real-world examples of vendors publishing security advisories in the CVRF format? I know of at least these:

## CVRF parsers

- https://github.com/oasis-open/csaf-parser
- https://github.com/mschiffm/cvrfparse

## References

- http://docs.oasis-open.org/csaf/csaf-cvrf/v1.2/cs01/csaf-cvrf-v1.2-cs01.html#_Toc493508911
